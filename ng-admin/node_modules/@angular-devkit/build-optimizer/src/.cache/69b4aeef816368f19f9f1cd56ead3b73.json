{"remainingRequest":"D:\\mygit\\HCWeChat\\ng-admin\\node_modules\\@angular-devkit\\build-optimizer\\src\\build-optimizer\\webpack-loader.js??ref--3-1!D:\\mygit\\HCWeChat\\ng-admin\\node_modules\\@delon\\auth\\token\\simple\\simple.interceptor.js","dependencies":[{"path":"D:\\mygit\\HCWeChat\\ng-admin\\node_modules\\@delon\\auth\\token\\simple\\simple.interceptor.js","mtime":1515671330000},{"path":"D:\\mygit\\HCWeChat\\ng-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":0},{"path":"D:\\mygit\\HCWeChat\\ng-admin\\node_modules\\@angular-devkit\\build-optimizer\\src\\build-optimizer\\webpack-loader.js","mtime":1519266497000}],"contextDependencies":[],"result":["import { Injectable, Injector } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { of } from 'rxjs/observable/of';\nimport { DA_SERVICE_TOKEN } from '../interface';\nimport { DA_OPTIONS_TOKEN } from '../../auth.options';\nvar SimpleInterceptor = /*@__PURE__*/ (function () {\n    function SimpleInterceptor(injector) {\n        this.injector = injector;\n    }\n    SimpleInterceptor.prototype.intercept = function (req, next) {\n        var options = this.injector.get(DA_OPTIONS_TOKEN);\n        if (options.ignores) {\n            for (var _i = 0, _a = options.ignores; _i < _a.length; _i++) {\n                var item = _a[_i];\n                if (item.test(req.url))\n                    return next.handle(req);\n            }\n        }\n        if (options.allow_anonymous_key && req.params.has(options.allow_anonymous_key)) {\n            return next.handle(req);\n        }\n        var model = this.injector.get(DA_SERVICE_TOKEN).get();\n        if (model && model.token) {\n            var token = (options.token_send_template || '${token}').replace(/\\$\\{([\\w]+)\\}/g, function (_, g) { return model[g] || ''; });\n            switch (options.token_send_place) {\n                case 'header':\n                    var obj = {};\n                    obj[options.token_send_key] = token;\n                    req = req.clone({\n                        setHeaders: obj\n                    });\n                    break;\n                case 'body':\n                    var body = req.body || {};\n                    body[options.token_send_key] = token;\n                    req = req.clone({\n                        body: body\n                    });\n                    break;\n                case 'url':\n                    var url = this.injector.get(Router).parseUrl(req.url);\n                    url.queryParams[options.token_send_key] = token;\n                    req = req.clone({\n                        url: url.toString()\n                    });\n                    break;\n            }\n        }\n        else {\n            if (options.token_invalid_redirect === true) {\n                this.injector.get(Router).navigate([options.login_url]);\n                return of({ status: 401, _from: 'simple_intercept' });\n            }\n        }\n        return next.handle(req);\n    };\n    return SimpleInterceptor;\n}());\nexport { SimpleInterceptor };\n//# sourceMappingURL=simple.interceptor.js.map \n",null]}