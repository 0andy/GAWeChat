{"remainingRequest":"D:\\mygit\\HCWeChat\\ng-admin\\node_modules\\@angular-devkit\\build-optimizer\\src\\build-optimizer\\webpack-loader.js??ref--3-1!D:\\mygit\\HCWeChat\\ng-admin\\node_modules\\@delon\\abc\\image\\image.directive.js","dependencies":[{"path":"D:\\mygit\\HCWeChat\\ng-admin\\node_modules\\@delon\\abc\\image\\image.directive.js","mtime":1515671330000},{"path":"D:\\mygit\\HCWeChat\\ng-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":0},{"path":"D:\\mygit\\HCWeChat\\ng-admin\\node_modules\\@angular-devkit\\build-optimizer\\src\\build-optimizer\\webpack-loader.js","mtime":1519266497000}],"contextDependencies":[],"result":["import { Directive, Input, ElementRef, Renderer2 } from '@angular/core';\nimport { ImageConfig } from './image.config';\n/**\n * img标签\n * + 支持微信、qq头像规则缩略图规则\n * + 支持移除http&https协议http\n * + 支持增加onerror事件\n */\nvar ImageDirective = /*@__PURE__*/ (function () {\n    function ImageDirective(el, render, DEF) {\n        this.el = el;\n        this.render = render;\n        this.size = 64;\n        this.error = './assets/img/logo.svg';\n        this.inited = false;\n        Object.assign(this, DEF);\n    }\n    ImageDirective.prototype.ngOnInit = function () {\n        this.update();\n        this.updateError();\n        this.inited = true;\n    };\n    ImageDirective.prototype.ngOnChanges = function (changes) {\n        if (this.inited) {\n            if (changes.error)\n                this.updateError();\n            else\n                this.update();\n        }\n    };\n    ImageDirective.prototype.update = function () {\n        var newSrc = this.src;\n        // region: fix weixin & qq avatar size\n        if (newSrc.includes('qlogo.cn')) {\n            var arr = newSrc.split('/'), size = arr[arr.length - 1];\n            arr[arr.length - 1] = (size === '0' || +size !== this.size) ? this.size.toString() : size;\n            newSrc = arr.join('/');\n        }\n        // endregion\n        // region: remove https & http\n        var isHttp = newSrc.startsWith('http:'), isHttps = newSrc.startsWith('https:');\n        if (isHttp || isHttps)\n            newSrc = newSrc.substr(isHttp ? 5 : 6);\n        // endregion\n        this.render.setAttribute(this.el.nativeElement, 'src', newSrc);\n    };\n    ImageDirective.prototype.updateError = function () {\n        this.render.setAttribute(this.el.nativeElement, 'onerror', \"this.src='\" + this.error + \"';\");\n    };\n    return ImageDirective;\n}());\nexport { ImageDirective };\n//# sourceMappingURL=image.directive.js.map \n",null]}